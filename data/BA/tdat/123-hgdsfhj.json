[
    {
        "type": "single",
        "question": "In the CRISP-DM methodology, which phase is explicitly responsible for creating the 'Data Dictionary' and performing 'Exploratory Data Analysis' (EDA)?",
        "options": [
            "Business Understanding",
            "Data Understanding",
            "Data Preparation",
            "Deployment"
        ],
        "answer": [
            1
        ],
        "explanation": "According to the CRISP-DM overview, the Data Understanding phase is where one takes inventory of sources, checks schemas, and performs EDA to reconcile definitions with real data[cite: 1164, 1184]."
    },
    {
        "type": "single",
        "question": "What is the primary characteristic difference between OLTP and OLAP workloads regarding data modification?",
        "options": [
            "OLTP involves fewer, large read operations.",
            "OLAP is designed for many small, atomic write transactions.",
            "OLTP systems are optimized for many small write transactions and point lookups.",
            "OLAP systems typically use row-oriented storage for fast updates."
        ],
        "answer": [
            2
        ],
        "explanation": "OLTP (Online Transaction Processing) is characterized by many small writes and normalized schemas. [cite_start]OLAP (Online Analytical Processing) focuses on fewer large reads and aggregations[cite: 46, 47]."
    },
    {
        "type": "single",
        "question": "In a SaaS KPI Tree where 'Monthly Recurring Revenue' (MRR) is the North Star, which variable acts as a direct mathematical driver in the formula: MRR = #Customers × ARPA × (1 - Churn)?",
        "options": [
            "Net Promoter Score (NPS)",
            "Average Revenue Per Account (ARPA)",
            "Server Latency",
            "Employee Satisfaction"
        ],
        "answer": [
            1
        ],
        "explanation": "In the standard SaaS KPI Tree, MRR is explicitly decomposed into #Customers, ARPA, and Churn. [cite_start]ARPA is a direct component of the equation[cite: 1285]."
    },
    {
        "type": "single",
        "question": "Which encoding strategy is most appropriate for a categorical feature 'T-Shirt Size' with values 'Small', 'Medium', and 'Large' when using a linear model?",
        "options": [
            "One-Hot Encoding",
            "Ordinal Encoding",
            "Hashing Encoding",
            "Frequency Encoding"
        ],
        "answer": [
            1
        ],
        "explanation": "Ordinal Encoding is best suited for categorical variables with a true ordering (S < M < L). [cite_start]It maps categories to integers that preserve this relationship[cite: 753, 754]."
    },
    {
        "type": "single",
        "question": "Which of the following scenarios represents 'Target Leakage' in a churn prediction model?",
        "options": [
            "Using 'Account_Cancellation_Date' as a feature.",
            "Using 'Customer_Age' derived from Date of Birth.",
            "Using 'Average_Monthly_Bill' from the past 6 months.",
            "Using 'Gender' as a demographic feature."
        ],
        "answer": [
            0
        ],
        "explanation": "Target leakage occurs when predictors include information available only after the outcome. [cite_start]'Account_Cancellation_Date' implies the churn event has already happened[cite: 718, 724]."
    },
    {
        "type": "single",
        "question": "If Table A has 3 rows and Table B has 3 rows, how many rows will result from a CROSS JOIN?",
        "options": [
            "3",
            "6",
            "9",
            "0"
        ],
        "answer": [
            2
        ],
        "explanation": "A CROSS JOIN produces the Cartesian product of the two tables (N x M). [cite_start]3 x 3 = 9 rows[cite: 109]."
    },
    {
        "type": "single",
        "question": "In the Medallion Architecture, what is the primary role of the 'Silver' layer?",
        "options": [
            "To store raw data exactly as ingested.",
            "To serve aggregated star schemas for BI dashboards.",
            "To hold cleaned, conformed, and deduplicated data ready for joins.",
            "To archive historical data that is no longer accessed."
        ],
        "answer": [
            2
        ],
        "explanation": "The Silver layer is for cleaned and conformed data, including deduplication and schema enforcement, making it ready for joins[cite: 85, 381]."
    },
    {
        "type": "single",
        "question": "A table has 10,000 rows. The 'Phone' column has 200 nulls and 50 invalid formats. What is the 'Validity' percentage?",
        "options": [
            "97.5%",
            "98.0%",
            "99.5%",
            "100%"
        ],
        "answer": [
            0
        ],
        "explanation": "Validity = (Total Rows - Invalid Rows) / Total Rows. 10,000 - (200 + 50) = 9,750 valid rows. [cite_start]9,750 / 10,000 = 97.5%[cite: 618, 620]."
    },
    {
        "type": "single",
        "question": "Which method is best for handling 'Missing Not At Random' (MNAR) data where the missingness contains business signal?",
        "options": [
            "Imputing with the global mean.",
            "Adding a binary 'is_missing' indicator flag.",
            "Dropping the rows entirely.",
            "Forward filling the previous value."
        ],
        "answer": [
            1
        ],
        "explanation": "For MNAR, the missingness depends on the value itself. Simple imputation biases the data. [cite_start]Adding an 'is_missing' flag captures the signal explicitly[cite: 681, 709]."
    },
    {
        "type": "single",
        "question": "In an SCD Type 2 dimension, what happens when a customer moves from 'Bronze' to 'Silver' tier?",
        "options": [
            "The existing row is overwritten with 'Silver'.",
            "A new column is added to the table.",
            "The old row is expired (valid_to set) and a new row is inserted (valid_from set).",
            "The customer ID is changed to a new unique value."
        ],
        "answer": [
            2
        ],
        "explanation": "SCD Type 2 maintains history by versioning rows. [cite_start]The old record is closed by updating `valid_to`, and a new record is created with the new value[cite: 67, 68]."
    },
    {
        "type": "single",
        "question": "Which SQL window frame specification includes the current row and the two rows immediately preceding it?",
        "options": [
            "ROWS BETWEEN 2 PRECEDING AND CURRENT ROW",
            "RANGE BETWEEN 2 PRECEDING AND CURRENT ROW",
            "ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING",
            "ROWS UNBOUNDED PRECEDING"
        ],
        "answer": [
            0
        ],
        "explanation": "`ROWS BETWEEN 2 PRECEDING AND CURRENT ROW` explicitly selects the physical rows: the current one and the two before it[cite: 571]."
    },
    {
        "type": "single",
        "question": "Calculate the 3-day simple moving average for the sequence [10, 20, 30, 40] at the last element (40).",
        "options": [
            "20",
            "30",
            "40",
            "25"
        ],
        "answer": [
            1
        ],
        "explanation": "The last 3 elements are 20, 30, 40. Average = (20 + 30 + 40) / 3 = 90 / 3 = 30[cite: 221]."
    },
    {
        "type": "single",
        "question": "Which of the following is considered a 'Lagging' indicator?",
        "options": [
            "Website Sessions",
            "Cart Additions",
            "Quarterly Revenue",
            "Customer Satisfaction Survey (Pre-churn)"
        ],
        "answer": [
            2
        ],
        "explanation": "Lagging indicators reflect the final outcomes of past actions. [cite_start]Revenue is a result that is measured after the business cycle is complete[cite: 1259, 1461]."
    },
    {
        "type": "single",
        "question": "What is the primary risk of using 'One-Hot Encoding' on a high-cardinality feature like 'Zip_Code'?",
        "options": [
            "It assumes an incorrect order of values.",
            "It causes dimensionality explosion and data sparsity.",
            "It cannot handle numeric data.",
            "It requires the data to be normally distributed."
        ],
        "answer": [
            1
        ],
        "explanation": "One-Hot Encoding creates a new column for every unique value. [cite_start]For high cardinality features, this leads to a massive number of columns (dimensionality explosion)[cite: 747]."
    },
    {
        "type": "single",
        "question": "Which technique handles outliers by capping them at specific percentiles (e.g., 1st and 99th)?",
        "options": [
            "Standardization (Z-score)",
            "Log Transformation",
            "Winsorization",
            "Min-Max Scaling"
        ],
        "answer": [
            2
        ],
        "explanation": "Winsorization (or capping) involves setting extreme outliers to a specified percentile value rather than removing them[cite: 830]."
    },
    {
        "type": "single",
        "question": "Which SQL Join strategy is used to find rows in the left table that have NO match in the right table?",
        "options": [
            "INNER JOIN",
            "ANTI JOIN (or LEFT JOIN with WHERE NULL)",
            "SEMI JOIN",
            "CROSS JOIN"
        ],
        "answer": [
            1
        ],
        "explanation": "An Anti Join returns rows from the left table where no match is found in the right table. [cite_start]It is often implemented as `LEFT JOIN ... WHERE right.key IS NULL`[cite: 138]."
    },
    {
        "type": "single",
        "question": "In the 'DOC' problem framing framework, what does 'C' stand for?",
        "options": [
            "Context",
            "Constraints",
            "Criteria",
            "Cost"
        ],
        "answer": [
            2
        ],
        "explanation": "DOC stands for Decision, Options, and Criteria. [cite_start]Criteria are the metrics used to evaluate the options[cite: 1334]."
    },
    {
        "type": "single",
        "question": "In which Medallion layer is it most appropriate to enforce logic like `session_start <= session_end`?",
        "options": [
            "Bronze",
            "Silver",
            "Gold",
            "Platinum"
        ],
        "answer": [
            1
        ],
        "explanation": "The Silver layer is responsible for cleaning and conforming data. [cite_start]Logic checks to remove invalid data happen here to ensure joinability[cite: 85, 389]."
    },
    {
        "type": "single",
        "question": "Using the IQR method (Q3 + 1.5*IQR), what is the upper outlier threshold if Q1=20 and Q3=50?",
        "options": [
            "80",
            "95",
            "125",
            "50"
        ],
        "answer": [
            1
        ],
        "explanation": "IQR = Q3 - Q1 = 50 - 20 = 30. Threshold = Q3 + 1.5*IQR = 50 + (1.5 * 30) = 50 + 45 = 95[cite: 1008]."
    },
    {
        "type": "single",
        "question": "What is the main benefit of using a Common Table Expression (CTE) over a subquery?",
        "options": [
            "It physically indexes the data.",
            "It improves code readability and allows reuse within the query.",
            "It always guarantees faster execution speed.",
            "It allows exporting data to a CSV file."
        ],
        "answer": [
            1
        ],
        "explanation": "CTEs are primarily used to break complex logic into named steps, improving readability and allowing the named result to be reused[cite: 175]."
    },
    {
        "type": "single",
        "question": "Optimizing the 'Checkout Page' directly influences which Lever in an E-commerce KPI Tree?",
        "options": [
            "Traffic Volume",
            "Conversion Rate (CR)",
            "Average Order Value (AOV)",
            "Churn Rate"
        ],
        "answer": [
            1
        ],
        "explanation": "Checkout optimization addresses the final step of the funnel, directly converting carts to purchases, thus improving the Conversion Rate[cite: 1145, 1272]."
    },
    {
        "type": "single",
        "question": "Which SQL syntax correctly queries a Delta/Snowflake table as it existed 1 hour ago?",
        "options": [
            "FROM table AS OF -1 HOUR",
            "FROM table AT (OFFSET => -3600)",
            "FROM table WHERE timestamp < NOW() - 3600",
            "FROM table ROLLBACK 1 HOUR"
        ],
        "answer": [
            1
        ],
        "explanation": "The standard syntax for time travel by offset is `AT (OFFSET => -seconds)`. [cite_start]1 hour is 3600 seconds[cite: 321]."
    },
    {
        "type": "single",
        "question": "Which feature represents 'Temporal Leakage' if used to predict loan default?",
        "options": [
            "Applicant's income at application time.",
            "Applicant's credit score at application time.",
            "Late payment flags generated 6 months post-loan.",
            "Loan amount requested."
        ],
        "answer": [
            2
        ],
        "explanation": "Features generated after the decision point (loan issuance) constitute leakage. [cite_start]Late payment flags are future outcomes[cite: 718]."
    },
    {
        "type": "single",
        "question": "What is the result of `COUNT(*)` on a table with 5 rows, where one row is entirely NULL?",
        "options": [
            "4",
            "5",
            "0",
            "Null"
        ],
        "answer": [
            1
        ],
        "explanation": "`COUNT(*)` counts all rows in the table, regardless of whether the values are null[cite: 402]."
    },
    {
        "type": "single",
        "question": "Which Feature Selection method involves training a model iteratively (e.g., Recursive Feature Elimination)?",
        "options": [
            "Filter Method",
            "Wrapper Method",
            "Embedded Method",
            "Unsupervised Method"
        ],
        "answer": [
            1
        ],
        "explanation": "Wrapper methods, like RFE, wrap the model training process to select the best subset of features[cite: 879, 893]."
    },
    {
        "type": "single",
        "question": "To find the valid product category for `product_id=50` on `2025-01-01` in an SCD2 table, which logic is correct?",
        "options": [
            "valid_from = '2025-01-01'",
            "valid_from <= '2025-01-01' AND (valid_to > '2025-01-01' OR valid_to IS NULL)",
            "is_current = TRUE",
            "valid_to = '2025-01-01'"
        ],
        "answer": [
            1
        ],
        "explanation": "The query date must fall inside the validity window: greater than or equal to start, and strictly less than end (or null)[cite: 77, 78]."
    },
    {
        "type": "single",
        "question": "What is the 'Completeness' rate if a column has 800 non-null values in 1,000 rows?",
        "options": [
            "20%",
            "80%",
            "0.8%",
            "100%"
        ],
        "answer": [
            1
        ],
        "explanation": "Completeness = (Non-null / Total) * 100. (800 / 1000) * 100 = 80%[cite: 618]."
    },
    {
        "type": "single",
        "question": "Which metric is a 'Guardrail' metric rather than a primary Business KPI?",
        "options": [
            "Revenue",
            "Page Load Latency",
            "Conversion Rate",
            "New Signups"
        ],
        "answer": [
            1
        ],
        "explanation": "Guardrails are health metrics ensuring the system functions correctly. [cite_start]Latency is a technical constraint, whereas Revenue/CR are business goals[cite: 1357]."
    },
    {
        "type": "single",
        "question": "What is the key difference between `RANK()` and `DENSE_RANK()`?",
        "options": [
            "RANK() leaves gaps in numbers after ties; DENSE_RANK() does not.",
            "DENSE_RANK() leaves gaps; RANK() does not.",
            "RANK() provides a unique number for every row.",
            "There is no difference."
        ],
        "answer": [
            0
        ],
        "explanation": "RANK() skips numbers (e.g., 1, 1, 3) while DENSE_RANK() is consecutive (1, 1, 2)[cite: 220, 238]."
    },
    {
        "type": "single",
        "question": "Which step comes first in the 'Data Value Chain'?",
        "options": [
            "Store",
            "Clean",
            "Collect",
            "Analyze"
        ],
        "answer": [
            2
        ],
        "explanation": "The chain starts with Collection, followed by Storage, Cleaning, Analysis, etc.[cite: 1126]."
    },
    {
        "type": "single",
        "question": "If you perform a LEFT JOIN between 'Orders' (100 rows) and 'Customers' (50 rows), and every order has one valid customer, how many rows are returned?",
        "options": [
            "50",
            "100",
            "150",
            "5000"
        ],
        "answer": [
            1
        ],
        "explanation": "A Left Join keeps all 100 rows from the left table. [cite_start]Since mapping is 1:1 or N:1 valid, the row count remains 100[cite: 125]."
    },
    {
        "type": "single",
        "question": "Which imputation method preserves multivariate correlations best for 'Missing At Random' (MAR) data?",
        "options": [
            "Global Median Imputation",
            "MICE (Multiple Imputation by Chained Equations)",
            "Zero Filling",
            "Dropping Rows"
        ],
        "answer": [
            1
        ],
        "explanation": "MICE models each feature iteratively based on others, preserving correlations, unlike global simple imputation[cite: 697, 698]."
    },
    {
        "type": "single",
        "question": "Which SQL function is used to calculate the 'Change in Revenue' from the previous day in the same row?",
        "options": [
            "LEAD()",
            "LAG()",
            "RANK()",
            "ROW_NUMBER()"
        ],
        "answer": [
            1
        ],
        "explanation": "`LAG()` retrieves data from a preceding row (e.g., yesterday) to compare with the current row[cite: 256]."
    },
    {
        "type": "single",
        "question": "A Z-score of +3.0 indicates the data point is:",
        "options": [
            "Equal to the mean.",
            "3 standard deviations below the mean.",
            "3 standard deviations above the mean.",
            "An error."
        ],
        "answer": [
            2
        ],
        "explanation": "Z-score measures standard deviations from the mean. [cite_start]Positive 3.0 means 3 SDs above[cite: 795, 820]."
    },
    {
        "type": "single",
        "question": "What is the primary purpose of a 'Data Contract'?",
        "options": [
            "To limit cloud storage costs.",
            "To agree on schema, quality, and SLAs between producers and consumers.",
            "To restrict data access to admins only.",
            "To encrypt data at rest."
        ],
        "answer": [
            1
        ],
        "explanation": "Data contracts define fields, definitions, and SLAs between data producers and consumers[cite: 960]."
    },
    {
        "type": "single",
        "question": "Which technique is used for Dimensionality Reduction while preserving variance?",
        "options": [
            "Principal Component Analysis (PCA)",
            "One-Hot Encoding",
            "Min-Max Scaling",
            "Upsampling"
        ],
        "answer": [
            0
        ],
        "explanation": "PCA projects data into orthogonal components to preserve variance while reducing dimensions[cite: 906]."
    },
    {
        "type": "single",
        "question": "How is 'Row-level Duplicate Rate' calculated?",
        "options": [
            "(Null Rows / Total Rows) * 100",
            "(Duplicate Rows / Total Rows) * 100",
            "(Total Rows / Unique Rows) * 100",
            "1 - Validity"
        ],
        "answer": [
            1
        ],
        "explanation": "The duplicate rate is the percentage of rows that are duplicates: (Count of duplicates / Total rows) * 100[cite: 623]."
    },
    {
        "type": "single",
        "question": "In a 'Sessionization' logic, what does `SUM(is_new_session) OVER (...)` calculate?",
        "options": [
            "The duration of the session.",
            "The unique Session ID.",
            "The total number of events.",
            "The number of users."
        ],
        "answer": [
            1
        ],
        "explanation": "By summing the 'is_new' flags (which are 1 when a new session starts) cumulatively, you generate a unique incrementing Session ID for each user's event stream[cite: 276]."
    },
    {
        "type": "single",
        "question": "Which missingness mechanism implies that the missing value depends on *other* observed variables?",
        "options": [
            "MCAR (Missing Completely at Random)",
            "MAR (Missing At Random)",
            "MNAR (Missing Not At Random)",
            "Systematic Error"
        ],
        "answer": [
            1
        ],
        "explanation": "MAR means missingness is related to observed data (e.g., income missingness depends on 'Plan Type')[cite: 658]."
    },
    {
        "type": "single",
        "question": "In the 'Bronze' layer of a Lakehouse, data is typically:",
        "options": [
            "Highly aggregated and ready for BI.",
            "Cleaned, deduped, and schema-enforced.",
            "Raw, append-only, with minimal transformation.",
            "Deleted after 24 hours."
        ],
        "answer": [
            2
        ],
        "explanation": "Bronze is the raw ingestion layer, keeping data in its original state (append-only)[cite: 84]."
    }
]